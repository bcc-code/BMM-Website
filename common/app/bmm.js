"use strict";angular.module("bmmLibApp",[]),angular.module("bmmLibApp").directive("bmmPlayerController",["$timeout","bmmUser",function(a,b){return{template:'<div bmm-video-container></div><div class="bmm-max-width"><div bmm-player-about title="hei"></div><div class="bmm-player-buttons"><div bmm-player-repeat></div><div bmm-player-clock>00:00</div><div bmm-player-mediaslider></div><div bmm-player-clock>00:00:00</div><div bmm-player-shuffle></div><div bmm-player-maincontrollers></div><div class="bmm-player-tools"><div bmm-track-tools></div><div bmm-volume-controller></div><div bmm-player-video></div></div></div></div>',compile:function(){return{pre:function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t="",u=!0,v=!1;d.addClass("bmm-player-controller"),a(function(){j=d.find(".bmm-player-buttons"),k=d.find(".bmm-player-repeat"),l=j.children(".bmm-player-mediaslider"),m=d.find(".bmm-player-shuffle"),n=d.find(".bmm-player-maincontrollers"),o=d.find(".bmm-player-tools"),p=d.find(".bmm-player-about"),q=d.find(".bmm-volume-controller"),r=d.find(".bmm-player-video"),s=d.find(".bmm-video-container"),i=d.parent().find(".bmm-player-target"),d.find(".bmm-player-clock").each(function(a){0===a?g=$(this):h=$(this)}),f=p.outerWidth(),z(),a(function(){x(),w()}),r.click(function(){var a=0;"topTools"===t&&(a=d.parent().find(".bmm-player-tools").height()),"true"===s.attr("active")?(s.attr("active","false"),"w"!==s.attr("direction")?(i.animate({height:d.parent().height()-a-(d.height()-b.getScreenHeight())},"fast"),s.animate({height:0},"fast",function(){d.find(".bmm-video-screen").hide(),$(window).trigger("resize")})):(i.animate({width:d.parent().width()-d.parent().find(".bmm-player-tools").width()},"fast"),s.animate({width:0},"fast",function(){d.parent().find(".bmm-video-screen").hide(),$(window).trigger("resize")}))):(s.attr("active","true"),d.parent().find(".bmm-video-screen").show(),"w"!==s.attr("direction")?(d.parent().find(".bmm-video-screen").css({width:(b.getScreenHeight()-10)/(9/16),height:b.getScreenHeight()-10,top:10}),i.animate({height:d.parent().height()-d.height()-b.getScreenHeight()-a},"fast"),s.animate({height:b.getScreenHeight()},"fast",function(){$(window).trigger("resize")})):(d.parent().find(".bmm-video-screen").css({width:b.getScreenWidth(),height:b.getScreenWidth()/(16/9),top:s.height()/2-b.getScreenWidth()/(16/9)/2}),i.animate({width:d.parent().width()-d.parent().find(".bmm-player-tools").width()-b.getScreenWidth()+1},"fast"),s.animate({width:b.getScreenWidth()},"fast",function(){$(window).trigger("resize")})))})}),$(window).resize(function(){z(),w(),a(function(){x()})});var w=function(){"sideTools"===t&&u?(u=!1,s.detach().insertAfter(i),s=d.parent().find(".bmm-video-container"),s.css({position:"absolute",right:d.parent().find(".bmm-player-tools").width()-1,height:i.height()+1,width:0}).attr({direction:"w"}),"true"===s.attr("active")&&s.css("width",b.getScreenWidth())):u||"normalTools"!==t&&"topTools"!==t?"sideTools"===t&&s.css({height:i.height()}):(u=!0,s.detach().prependTo(d),s=d.find(".bmm-video-container"),s.css({position:"",right:"",height:0,width:""}).attr({direction:"n"}),"true"===s.attr("active")&&s.css("height",b.getScreenHeight()))},x=function(){i.css("zIndex","20"),""===t||"normalTools"===t?i.css({position:"absolute",top:"0",width:"100%",height:d.parent().outerHeight()-d.outerHeight()+1}):"topTools"===t?i.css({position:"absolute",top:o.outerHeight(),width:"100%",height:d.parent().outerHeight()-d.outerHeight()-o.outerHeight()+1}):"sideTools"===t&&i.css({position:"absolute",top:"0",width:d.parent().outerWidth()-o.outerWidth(),height:d.parent().outerHeight()-d.outerHeight()+1})},y=function(){e=k.width()+g.width()+h.width()+m.width(),e=j.width()-(e+e/1.8),l.width(e).attr("length",e)},z=function(){j.width()<1.8*f&&!v?(v=!0,A("minified")):j.width()>=2.8*f&&v?(v=!1,A(),y()):j.width()>=1.8*f&&!v&&y(),d.width()<450&&"topTools"!==t?A("topTools"):d.parent().height()<350&&"sideTools"!==t&&d.width()>=450&&v===!0?A("sideTools"):("normalTools"!==t&&d.width()>=450&&d.parent().height()>=350||v===!1&&"sideTools"===t)&&A("normalTools")},A=function(a){switch("undefined"!=typeof a&&"minified"!==a&&(t=a),a){case"minified":var b;p.addClass("bmm-minified"),p.css({padding:".5em 0 0 .8em",height:"","float":"none"}),p.after('<div class="bmm-player-minitimer"></div>'),b=d.find(".bmm-player-minitimer"),k.detach().appendTo(b),g.detach().appendTo(b),b.html(b.html()+"<div>&nbsp/&nbsp</div>"),h.detach().appendTo(b),m.detach().appendTo(b),b.children().css("float","left"),b.css({position:"absolute",top:".5em",right:".8em"}),j.css("padding",".5em"),l.css({width:"","float":"none"});break;case"topTools":q.attr({length:"4em",orientation:"horizontal"}),d.css("paddingTop",""),n.insertAfter(l),r.detach().insertAfter(n).css("float","right"),o.detach().prependTo(d.parent()).css({position:"absolute",top:"0",left:"0",right:"",width:"100%",height:"",background:"#1c1c1c"});break;case"normalTools":d.css("paddingTop",""),q.attr({length:"5em",orientation:"horizontal"}),d.find(".bmm-player-minitimer").length>0?n.insertAfter(l):n.insertAfter(m),d.parent().find(".bmm-player-tools").detach().insertAfter(n).css({position:"",top:"",left:"",right:"",width:"",height:"",background:""}).children().css("float",""),r.detach().appendTo(o).css("float","");break;case"sideTools":d.css("paddingTop",".3em"),q.attr({length:"2.5em",orientation:"vertical"}),o.detach().prependTo(d.parent()).css({position:"absolute",top:"0",left:"",right:"0",width:"2em",background:"#1c1c1c",height:"100%"}).children().css("float","left"),n.insertAfter(s),r.detach().insertBefore(n).css({height:"1.8em","float":"left"});break;default:k.detach().insertBefore(l).css("float",""),g.detach().insertBefore(l).css("float",""),m.detach().insertAfter(l).css("float",""),h.detach().insertAfter(l).css("float",""),d.find(".bmm-player-minitimer").remove(),j.css("padding",""),l.css("float",""),p.removeClass("bmm-minified"),p.css({padding:"","float":""}),n.detach().insertAfter(m)}}}}}}}]),angular.module("bmmLibApp").directive("bmmPlayerAbout",[function(){return{template:'<div class="bmm-player-thumbnail"></div><div class="bmm-player-title"></div><div class="bmm-player-subtitle"></div><div class="bmm-player-extra"></div>',link:function(a,b,c){b.addClass("bmm-player-about");var d=function(){"undefined"!=typeof c.thumbnail&&b.find(".bmm-player-thumbnail").css({background:'url("'+c.thumbnail+'")'}),b.find(".bmm-player-title").append(c.title),b.find(".bmm-player-subtitle").append(c.subtitle),b.find(".bmm-player-extra").append(c.extra),b.css({overflow:"hidden"}),e(),$(window).resize(function(){e()})},e=function(){b.hasClass("bmm-minified")?b.height("auto"):b.height(b.find(".bmm-player-thumbnail").outerHeight())};d()}}}]),angular.module("bmmLibApp").directive("bmmPlayerMaincontrollers",[function(){return{template:"<div bmm-player-previous></div><div bmm-player-play></div><div bmm-player-next></div>",link:function(a,b){b.addClass("bmm-player-maincontrollers")}}}]),angular.module("bmmLibApp").directive("bmmPlayerMediaslider",["$timeout",function(a){return{template:'<div class="bmm-player-mediaslider-behind"></div>',compile:function(){return{pre:function(b,c){c.addClass("bmm-player-mediaslider");var d=c.find(".bmm-player-mediaslider-behind"),e="";d.css({position:"absolute",bottom:"0"});var f=function(){b.$watch(function(){return c.attr("orientation")},function(){a(function(){g()})})},g=function(){"undefined"!=typeof c.attr("length")&&(e=c.attr("length")),"undefined"!=typeof c.attr("orientation")&&"vertical"===c.attr("orientation")?(c.find(".ui-slider-handle").css({left:""}),c.css({width:"",height:e}),d.css({width:"100%",height:"0"}),c.slider({orientation:"vertical",slide:function(a,b){d.css({height:b.value+"%"})}})):(c.css({width:e,height:""}),d.css({width:"0",height:"100%"}),c.slider({orientation:"horizontal",slide:function(a,b){d.css({width:b.value+"%"})}}))};f()}}}}}]),angular.module("bmmLibApp").directive("bmmPlayerPlay",[function(){return{link:function(a,b){b.addClass("bmm-player-play")}}}]),angular.module("bmmLibApp").directive("bmmPlayerPrevious",[function(){return{link:function(a,b){b.addClass("bmm-player-previous")}}}]),angular.module("bmmLibApp").directive("bmmPlayerNext",[function(){return{link:function(a,b){b.addClass("bmm-player-next")}}}]),angular.module("bmmLibApp").directive("bmmPlayerRepeat",[function(){return{link:function(a,b){b.addClass("bmm-player-repeat")}}}]),angular.module("bmmLibApp").directive("bmmPlayerShuffle",[function(){return{link:function(a,b){b.addClass("bmm-player-shuffle")}}}]),angular.module("bmmLibApp").directive("bmmPlayerClock",[function(){return{link:function(a,b){b.addClass("bmm-player-clock")}}}]),angular.module("bmmLibApp").directive("bmmPlayerVideo",[function(){return{link:function(a,b){b.addClass("bmm-player-video")}}}]),angular.module("bmmLibApp").directive("bmmTrackFavorite",[function(){return{link:function(a,b){b.addClass("bmm-track-favorite")}}}]),angular.module("bmmLibApp").directive("bmmTrackTimer",[function(){return{link:function(a,b){b.addClass("bmm-track-timer")}}}]),angular.module("bmmLibApp").directive("bmmTrackShare",[function(){return{link:function(a,b){b.addClass("bmm-track-share")}}}]),angular.module("bmmLibApp").directive("bmmTrackDownload",[function(){return{link:function(a,b){b.addClass("bmm-track-download")}}}]),angular.module("bmmLibApp").directive("bmmTrackTools",[function(){return{template:"<div bmm-track-favorite></div><div bmm-track-timer></div><div bmm-track-share></div><div bmm-track-download></div>",link:function(a,b){b.addClass("bmm-track-tools")}}}]),angular.module("bmmLibApp").directive("bmmVideoContainer",["$timeout","bmmUser",function(a,b){return{template:"<div bmm-video-screen></div>",compile:function(){return{pre:function(c,d){var e,f;d.addClass("bmm-video-container"),a(function(){e=d.find(".bmm-video-screen"),h(),$(window).resize(function(){h(),g()})});var g=function(){"undefined"!=typeof d.attr("direction")&&"w"===d.attr("direction")?(e.width(d.width()),e.height(d.width()/(16/9)),e.css({top:d.height()/2-e.height()/2})):(e.css("top",10),e.height(d.height()-10),e.width(d.height()/(9/16)))},h=function(){if("undefined"!=typeof d.attr("direction")){if(f!==d.attr("direction"))switch(f=d.attr("direction"),d.resizable("destroy"),f){case"n":d.resizable({handles:f,resize:function(a,c){d.css("top",""),d.attr("active","true"),b.setScreenHeight(c.size.height),e.show()}});break;case"w":d.resizable({handles:f,resize:function(a,c){d.css("left",""),d.attr("active","true"),b.setScreenWidth(c.size.width),e.show()}});break;default:d.resizable({handles:f})}}else"undefined"==typeof f&&(f="n",d.resizable({handles:f,resize:function(a,c){d.css("top",""),d.attr("active","true"),b.setScreenHeight(c.size.height),e.show()}}))}}}}}}]),angular.module("bmmLibApp").directive("bmmVideoScreen",[function(){return{template:"<div bmm-video-fullscreen></div>",compile:function(){return{pre:function(a,b){b.addClass("bmm-video-screen")}}}}}]),angular.module("bmmLibApp").directive("bmmVideoFullscreen",[function(){return{compile:function(){return{pre:function(a,b){b.addClass("bmm-video-fullscreen")}}}}}]),angular.module("bmmLibApp").directive("bmmVolumeController",["$timeout",function(a){return{template:"<div bmm-volume-mute></div><div bmm-volume-slider></div><div bmm-volume-max></div>",compile:function(){return{pre:function(b,c){var d,e=0;c.addClass("bmm-volume-controller"),a(function(){d=c.find(".bmm-volume-slider"),c.children().css("float","left"),f(),$(window).resize(function(){f()})});var f=function(){0===e&&(d.find(".bmm-player-mediaslider").css("width","5em"),c.children().each(function(){e+=$(this).width()}));var a="horizontal";"undefined"!=typeof c.attr("orientation")?a=c.attr("orientation"):c.parent().width()<=e&&(a="vertical"),"vertical"===a?(d.attr("orientation","vertical").css({marginTop:"",marginLeft:".65em"}),c.children().css("float","none")):(d.attr("orientation","horizontal").css({marginTop:".65em",marginLeft:""}),c.children().css("float","left")),"undefined"!=typeof c.attr("length")&&d.attr("length",c.attr("length"))}}}}}}]),angular.module("bmmLibApp").directive("bmmVolumeSlider",["$timeout",function(a){return{template:'<div bmm-player-mediaslider class="bmm-minified"></div>',compile:function(){return{pre:function(b,c){var d,e="horizontal",f="5em";c.addClass("bmm-volume-slider"),a(function(){d=c.find(".bmm-player-mediaslider"),d.attr("length",f),b.$watch(function(){return c.attr("")},function(){"undefined"!=typeof c.attr("orientation")&&(e=c.attr("orientation")),"undefined"!=typeof c.attr("length")&&(f=c.attr("length")),d.attr("orientation",e),d.attr("length",f)}),$(window).resize(function(){"undefined"!=typeof c.attr("orientation")&&c.attr("orientation")!==e&&(e=c.attr("orientation"),b.$apply(function(){d.attr("orientation",e)})),"undefined"!=typeof c.attr("length")&&c.attr("length")!==f&&(f=c.attr("length"),b.$apply(function(){d.attr("length",f)}))})})}}}}}]),angular.module("bmmLibApp").directive("bmmVolumeMute",[function(){return{link:function(a,b){b.addClass("bmm-volume-mute")}}}]),angular.module("bmmLibApp").directive("bmmVolumeMax",[function(){return{link:function(a,b){b.addClass("bmm-volume-max")}}}]),angular.module("bmmLibApp").directive("bmmResize",[function(){return{link:function(a,b){b.resizable()}}}]),angular.module("bmmLibApp").directive("bmmContainerMain",[function(){return{compile:function(){return{pre:function(a,b){b.addClass("bmm-container-main")}}}}}]),angular.module("bmmLibApp").factory("bmmUser",function(){var a={},b={},c="main",d=!0;return b.screen={},b.screen.height="180",b.screen.width="180",a.getScreenWidth=function(){return b.screen.width},a.getScreenHeight=function(){return b.screen.height},a.getCurrentNavigator=function(){return c},a.setScreenWidth=function(a){b.screen.width=a},a.setScreenHeight=function(a){b.screen.height=a},a.setCurrentNavigator=function(a){c=a},a.displayNavigator=function(a){return"undefined"!=typeof a&&(d=a),d},a}),angular.module("bmmLibApp").directive("bmmContainerHeader",["$timeout",function(a){return{compile:function(){return{pre:function(b,c){var d,e,f,g,h=!1;c.addClass("bmm-container-header"),a(function(){a(function(){a(function(){i()})})}),$(window).resize(function(){i()});var i=function(){f=c.parent().height(),g=c.height(),e=4*g,h||("undefined"==typeof d&&(e>f||c.width()<800)?(c.parent().find(".bmm-navigator-playlist").addClass("minified"),c.css("display","none"),d=!1):"undefined"==typeof d?d=!0:d&&(e>f||c.parent().width()<800)?(c.parent().find(".bmm-navigator-playlist").addClass("minified"),h=!0,c.animate({height:0},"fast",function(){c.css({height:"",display:"none"}),h=!1,i()}),d=!1):!d&&f>=e&&c.parent().width()>=800&&(c.parent().find(".bmm-navigator-playlist").removeClass("minified"),h=!0,c.css({height:0,display:""}).animate({height:g},"fast",function(){h=!1,i()}),d=!0))}}}}}}]),angular.module("bmmLibApp").directive("bmmNavigatorMain",["$timeout","bmmUser",function(a,b){return{compile:function(){return{pre:function(c,d){var e,f,g,h,i,j="undefined",k=!1;d.addClass("bmm-navigator-main"),a(function(){m()}),$(window).resize(function(){m()});var l=function(){h.bind("click",function(){0===d.height()&&0===f.height()?("medium"===j&&b.displayNavigator(!0),"main"===b.getCurrentNavigator()?(g.width(""),d.height("").animate({marginLeft:0})):(g.width(""),f.height("").animate({marginLeft:0}))):("medium"===j&&b.displayNavigator(!1),"main"===b.getCurrentNavigator()?d.animate({marginLeft:-d.width()},"fast",function(){d.height(0),g.width("100%")}):f.animate({marginLeft:-f.width()},"fast",function(){f.height(0),g.width("100%")}))}),i.click(function(){0===d.height()?(b.setCurrentNavigator("main"),f.animate({marginLeft:-f.width()},"fast",function(){f.height(0),d.height("").animate({marginLeft:0})})):(b.setCurrentNavigator("playlist"),d.animate({marginLeft:-d.width()},"fast",function(){d.height(0),f.height("").animate({marginLeft:0})}))})},m=function(){f=d.parent().find(".bmm-navigator-playlist"),e=d.parent().width(),g=d.parent().find(".bmm-view"),i=d.parent().find(".bmm-navigator-switch"),h=d.parent().find(".bmm-navigator-toggle"),i.removeClass("load"),h.removeClass("load"),k||(k=!0,l()),600>e?"small"!==j&&(d.parent().css({margin:0,height:"100%"}),h.show(),i.show(),d.addClass("minified"),g.addClass("minified"),"undefined"===j||"main"!==b.getCurrentNavigator()?(d.css({height:0,marginLeft:-f.width()}),"undefined"===j&&g.width("100%")):d.animate({marginLeft:-f.width()},"fast",function(){d.height(0),g.width("100%")}),j="small"):800>e&&"medium"!==j?(g.width(""),d.parent().css({margin:0,height:"100%"}),b.displayNavigator()&&"main"===b.getCurrentNavigator()?"large"===j?(h.show(),i.show(),d.animate({height:0},"fast",function(){d.addClass("minified"),g.addClass("minified"),d.css("marginLeft",-d.width()),f.animate({marginLeft:-f.width()},"fast",function(){f.height(0),d.height("").animate({marginLeft:0})})})):0===d.height()?d.height("").animate({marginLeft:0}):"undefined"===j&&(d.addClass("minified"),g.addClass("minified"),h.show(),i.show()):b.displayNavigator()?"main"===b.getCurrentNavigator()?(d.addClass("minified"),"small"===j&&0!==d.height()?b.displayNavigator(!0):d.css({marginLeft:-d.width(),height:0})):d.animate({height:0},"fast",function(){"large"!==j&&(d.css({marginLeft:-d.width()}),d.addClass("minified"),h.fadeIn(),i.fadeIn(),g.addClass("minified"))}):(h.show(),i.show(),"large"===j&&d.animate({height:0},"fast",function(){d.addClass("minified"),g.addClass("minified"),d.css("marginLeft",-d.width()),f.animate({marginLeft:-f.width()},"fast",function(){f.height(0),g.width("100%")})})),j="medium"):e>=800&&"large"!==j&&(d.parent().css({margin:"",height:""}),g.width(""),"medium"!==j&&"small"!==j||"main"!==b.getCurrentNavigator()?0===f.height()?(h.hide(),i.hide(),d.removeClass("minified"),g.removeClass("minified"),d.css({marginLeft:"",height:""}),f.height("").animate({marginLeft:0},"fast")):(h.hide(),i.hide(),d.removeClass("minified"),g.removeClass("minified"),d.css({marginLeft:"",height:""})):(h.hide(),i.hide(),d.animate({marginLeft:-d.width()},"fast",function(){d.removeClass("minified"),g.removeClass("minified"),d.css({marginLeft:"",height:""}),f.height("").animate({marginLeft:0},"fast",function(){f.css({marginLeft:""})})})),j="large")}}}}}}]),angular.module("bmmLibApp").directive("bmmNavigatorPlaylist",["$timeout","bmmUser",function(a,b){return{compile:function(){return{pre:function(c,d){var e,f,g,h="undefined";d.addClass("bmm-navigator-playlist"),a(function(){i()}),$(window).resize(function(){i()});var i=function(){f=d.parent().find(".bmm-navigator-main"),e=d.parent().width(),g=d.parent().find(".bmm-view"),600>e?"small"!==h&&(b.displayNavigator&&"playlist"===b.getCurrentNavigator()?d.animate({marginLeft:-f.width()},"fast",function(){d.height(0),g.width("100%")}):d.css({height:0,marginLeft:-f.width()}),h="small"):800>e&&"medium"!==h?(b.displayNavigator()||"playlist"!==b.getCurrentNavigator()||"small"!==h||0===d.height()?"playlist"!==b.getCurrentNavigator()&&"undefined"===h?d.css({height:0,marginLeft:-f.width()}):b.displayNavigator()&&"playlist"===b.getCurrentNavigator()&&0===d.height()&&d.height("").animate({marginLeft:0}):b.displayNavigator(!0),h="medium"):"large"!==h&&e>=800&&(h="large")}}}}}}]);